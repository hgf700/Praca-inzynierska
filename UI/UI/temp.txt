static string GetResultFileName()
        {
            string dir = "../../../wyniki";
            Directory.CreateDirectory(dir);
            int num = 1;
            string name;
            do { name = Path.Combine(dir, $"genetic_Result{num}.csv"); num++; }
            while (File.Exists(name));
            return name;
        }



private Task StartNNWorker(CancellationToken token)
    {
        return Task.Run(() =>
        {
            var model = GetModel();
            using var session = new InferenceSession(model);

            var modelResult = GetModelResultFileName();

            using var writer = new StreamWriter(modelResult, false, Encoding.UTF8);

            // ?? Nag³ówek CSV
            writer.WriteLine(
                "day,shift,worker_id,preference,requirements,singleWorkerFitness,prediction"
            );

            try
            {
                foreach (var input in inputQueue.GetConsumingEnumerable(token))
                {
                    // 1?? Tensor [1,6]
                    var tensor = new DenseTensor<float>(
                        input,
                        new[] { 1, input.Length }
                    );

                    var inputs = new List<NamedOnnxValue>
                {
                    NamedOnnxValue.CreateFromTensor("input", tensor)
                };

                    // 2?? Predykcja
                    using var results = session.Run(inputs);
                    float prediction = results.First().AsTensor<float>()[0];

                    // 3?? Zapis do CSV
                    string csvLine =
                        $"{input[0]},{input[1]},{input[2]},{input[3]},{input[4]},{input[5]},{prediction}";

                    writer.WriteLine(csvLine);
                    writer.Flush(); // ?? wa¿ne przy d³ugim dzia³aniu

                    // 4?? Opcjonalnie do kolejki
                    outputQueue.Add(new[] { prediction }, token);
                }
            }
            catch (OperationCanceledException)
            {
                // graceful shutdown
            }
        }, token);
    }
